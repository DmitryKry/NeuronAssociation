# Дополнительный код для визуализации архитектуры
from tensorflow.keras.utils import plot_model
import matplotlib.pyplot as plt

# Визуализируем модель
plt.figure(figsize=(12, 8))
plot_model(model, 
           to_file='model_architecture.png',
           show_shapes=True,
           show_layer_names=True,
           dpi=96,
           rankdir='TB')  # TB - сверху вниз, LR - слева направо

print("Архитектура модели сохранена в 'model_architecture.png'")

# Альтернативная текстовая визуализация
print("\n" + "="*50)
print("ТЕКСТОВАЯ ВИЗУАЛИЗАЦИЯ АРХИТЕКТУРЫ")
print("="*50)

architecture = """
    🎯 АРХИТЕКТУРА НЕЙРОННОЙ СЕТИ
    
    ВХОДНЫЕ ДАННЫЕ
        ↓
    [5 features]
        ↓
    ┌─ Dense(15) ──┐    ← 5×15 = 75 весов
    │   relu       │    ← 15 смещений
    └──────────────┘
        ↓
    [15 нейронов]
        ↓
    ┌─ Dense(10) ──┐    ← 15×10 = 150 весов
    │   relu       │    ← 10 смещений
    └──────────────┘
        ↓
    [10 нейронов]
        ↓
    ┌─ Dense(5) ───┐    ← 10×5 = 50 весов
    │   relu       │    ← 5 смещений
    └──────────────┘
        ↓
    [5 нейронов]
        ↓
    ┌─ Dense(1) ───┐    ← 5×1 = 5 весов
    │   linear     │    ← 1 смещение
    └──────────────┘
        ↓
    ВЫХОД (1 значение)
"""

print(architecture)

# Детализация параметров
print("\n" + "="*50)
print("ДЕТАЛИ ПАРАМЕТРОВ ПО СЛОЯМ:")
print("="*50)

layer_details = [
    ("Dense(15)", "5 входов → 15 нейронов", "5×15 = 75 весов", "15 смещений", "90 параметров"),
    ("Dense(10)", "15 входов → 10 нейронов", "15×10 = 150 весов", "10 смещений", "160 параметров"),
    ("Dense(5)", "10 входов → 5 нейронов", "10×5 = 50 весов", "5 смещений", "55 параметров"),
    ("Dense(1)", "5 входов → 1 нейрон", "5×1 = 5 весов", "1 смещение", "6 параметров")
]

print(f"{'Слой':<15} {'Соединение':<20} {'Веса':<20} {'Смещения':<15} {'Всего':<10}")
print("-" * 80)
for layer, connection, weights, biases, total in layer_details:
    print(f"{layer:<15} {connection:<20} {weights:<20} {biases:<15} {total:<10}")

print("-" * 80)
print(f"{'ИТОГО:':<15} {'':<20} {'':<20} {'':<15} {'311':<10}")